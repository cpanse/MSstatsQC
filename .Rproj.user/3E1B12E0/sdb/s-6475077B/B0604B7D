{
    "collab_server" : "",
    "contents" : "#' A Change Point (CP) Function\n#'\n#' This function allows you to calculate change point statistics for a step change.\n#' @param data Comma-separated (*.csv), QC file format. It should contain a Precursor column and the metrics columns.\n#' @param peptide The name of precursor you want to draw the plot for\n#' @param L Lower bound of the giude set\n#' @param U Upper bound of the guide set\n#' @param ytitle The y-axis title of the plot. The x-axis title is by default \"QCno-name of peptide\"\n#' @param type can take two values, \"mean\" or \"dispersion\".\n#' @keywords Change point\n#'          control chart\n#' @export\n#' @import dplyr\n#' @import plotly\n#' @import RecordLinkage\n#' @examples\n#' CP.plot()\n\n###############################################################################################\nCP.plot <- function(data, peptide, L = 1, U = 5, metric, normalization = TRUE,  ytitle = \"Change Point Plot\", type = \"mean\") {\n\n  data <- input_checking(data)\n  if(!is.data.frame(data)){\n    stop(data)\n  }\n  metricData <- getMetricData(data, peptide, L, U, metric, normalization)\n  precursor.data <- data[data$Precursor==peptide,]\n  ## Create variables\n  plot.data <- CP.data.prepare(data, metricData, type)\n  y.max=max(plot.data$Et) # y axis upper limit\n  y.min=0 # y axis lower limit\n\n  x <- list(\n    title = paste(\"QCno - \", peptide)\n  )\n  y <- list(\n    title = ytitle\n  )\n\n  plot_ly(plot.data, x = QCno, y = Et\n          ,type = \"scatter\"\n          ,line = list(shape = \"linear\")\n          ,showlegend = FALSE,name=\"\"\n          , text=precursor.data$Annotations\n  ) %>%\n    layout(xaxis = x,yaxis = y) %>%\n    add_trace( x = c(tho.hat,tho.hat), y = c(0, (max(Et)+2))\n               ,marker=list(color=\"red\", size=4, opacity=0.5)\n               , mode = \"lines\"\n               ,showlegend = FALSE,name=\"\"\n    ) %>%\n    add_trace(x = QCno, y =  Et\n              ,mode = \"markers\"\n              , marker=list(color=\"blue\" , size=8 , opacity=0.5)\n              ,showlegend = FALSE,name=\"\"\n    )\n}\n",
    "created" : 1483807555333.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1009124078",
    "id" : "B0604B7D",
    "lastKnownWriteTime" : 1483809619,
    "last_content_update" : 1483809619561,
    "path" : "~/GitHub/MSstatsQC/R/CP.plot.R",
    "project_path" : "R/CP.plot.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}